import{c as d,B as p,q as n,o as C,n as I,a as A,C as R,D as m,_,d as l,i,l as D,R as j,f as x}from"./q-CBAji49d.js";import{_ as s}from"./q-uemlvruI.js";import{b as N}from"./q-TJBU60mj.js";import{WeatherContext as q}from"./q-Cait45K_.js";import{W as H}from"./q-BXNFiO8U.js";const $=({track:t})=>{const[e]=d();if(t(()=>e.weatherToday),e.weatherToday){const o=e.weatherToday,a=new Date().toLocaleTimeString("en",{timeStyle:"short",hour12:!1,timeZone:o.timezone}).split(":"),c=document.querySelector(`#i${a[0]}`);if(c){c.classList.add("current");const u=c.nextElementSibling;u instanceof HTMLSpanElement&&u.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})}}},k=p(n(()=>s(()=>import("./q-MCvHYk_K.js"),[]),"s_oQnubcoI5HI")),J=p(n(()=>s(()=>import("./q-BvyVI8Wy.js"),[]),"s_SdTHsMBGSa0")),V=p(n(()=>s(()=>import("./q-X3J0hX5P.js"),[]),"s_0ADYAZ4tl5U")),W=()=>{const t=C({displayLocation:"",error:"",forecast:null,query:"",weatherToday:null});I(q,t);const e=A(N),o=n(()=>s(()=>Promise.resolve().then(()=>h),void 0),"s_0CAUp0JTeY8",[e]),r=R(n(()=>s(()=>Promise.resolve().then(()=>h),void 0),"s_ZrRVap1iTHs",[t]));return m(n(()=>s(()=>Promise.resolve().then(()=>h),void 0),"s_zqpXT8B27s0",[t])),m(n(()=>s(()=>Promise.resolve().then(()=>h),void 0),"s_vg3z8wZWCPA",[t])),m(n(()=>s(()=>Promise.resolve().then(()=>h),void 0),"s_9Dk7fUYNCDI",[t])),_("div",null,{class:"weather-app"},[_("button",null,{class:"about-btn",onClick$:o},"⚙",3,null),_("div",null,{class:"inner"},_("h1",null,null,"Check the Weather",3,null),3,null),_("form",null,{class:"inner","preventdefault:submit":!0},[l(J,null,3,"H1_1"),l(j,{onPending:()=>l(V,null,3,"H1_2"),onRejected:a=>l(k,{get message(){return a.message},[i]:{message:D(a,"message")}},3,"H1_3"),onResolved:()=>l(H,null,3,"H1_4"),value:r,[i]:{onPending:i,onRejected:i,onResolved:i,value:i}},3,"H1_5")],1,null)],1,"H1_6")};async function z(t,e){function o(P){const b=P.toUpperCase().split("").map(O=>127397+O.charCodeAt(0));return String.fromCodePoint(...b)}const r={displayLocation:"",forecast:{},weatherToday:{}};if(/,\s/.test(t)||t.length<4)throw new Error("Please enter the city name (only) or a zip code.");const a=await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${t}&count=10&language=en&format=json`,{signal:e.signal});if(!a.ok)throw new Error("Something went wrong when fetching the geo location.");const c=await a.json();if(!c.results)throw new Error(`“${t}” not found.`);const{latitude:u,longitude:w,timezone:g,name:T,admin1:f,country_code:S}=c.results[0];r.displayLocation=`${T}${f?`, ${f}`:""} ${o(S)}`;const y=await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${u}&longitude=${w}&timezone=${g}&temperature_unit=fahrenheit&forecast_days=8&daily=weathercode,temperature_2m_max,temperature_2m_min`,{signal:e.signal});if(!y.ok)throw new Error("Something went wrong when fetching the forecast.");const E=await y.json();r.forecast=E.daily;const v=await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${u}&longitude=${w}&timezone=${g}&temperature_unit=fahrenheit&forecast_days=2&hourly=weathercode,temperature_2m,temperature_2m&daily=temperature_2m_max,temperature_2m_min`,{signal:e.signal});if(!v.ok)throw new Error("Something went wrong when fetching the forecast.");const L=await v.json();return r.weatherToday=L,r}const M=async({track:t,cleanup:e})=>{const[o]=d();t(()=>o.query);const r=new AbortController;e(()=>r.abort("cleanup"));const a=await z(o.query,r);return a&&"displayLocation"in a&&(o.displayLocation=a.displayLocation,o.forecast=a.forecast,o.weatherToday=a.weatherToday),a},Q=p(n(()=>s(()=>import("./q-Dm7biMwy.js"),[]),"s_5Wn3iQBlyEQ")),U=()=>{const[t]=d();document.body.classList.add("lock"),t("modal",l(Q,{content:`
          <p>This is an enhanced version of the Classy Weather project in Jonas Schmedtmann’s Ultimate React Course, converted to the Qwik framework. It is offered without warrants or represents.</p>
          <p>The data you enter is stored on this device using your browser’s built-in storage. This can be emptied by clearing your browser data. The app tracks nothing.</p>
          <p>Weather data courtesy of open-meteo.com. Enjoy!</p>
          <p><a href="https://codesynopsis.com/apps">More apps</a></p>
        `,[i]:{content:i}},3,"H1_0"))},B=()=>{const[t]=d(),e=localStorage.getItem("weatherLocation");e&&JSON.parse(e).length&&JSON.parse(e)!==t.query?t.query=JSON.parse(e):t.query="Bellingham"},Y=({track:t})=>{const[e]=d();t(()=>e.query);const o=localStorage.getItem("weatherLocation");o&&JSON.parse(o).length&&JSON.parse(o)!==e.query&&e.query.length||!(o&&JSON.parse(o).length)?localStorage.setItem("weatherLocation",JSON.stringify(e.query)):o&&JSON.parse(o).length&&JSON.parse(o)!==e.query&&!e.query.length&&localStorage.removeItem("weatherLocation")},h=Object.freeze(Object.defineProperty({__proto__:null,_hW:x,s_0CAUp0JTeY8:U,s_9Dk7fUYNCDI:$,s_ZrRVap1iTHs:M,s_vg3z8wZWCPA:Y,s_xYL1qOwPyDI:W,s_zqpXT8B27s0:B},Symbol.toStringTag,{value:"Module"}));export{x as _hW,U as s_0CAUp0JTeY8,$ as s_9Dk7fUYNCDI,M as s_ZrRVap1iTHs,Y as s_vg3z8wZWCPA,W as s_xYL1qOwPyDI,B as s_zqpXT8B27s0};
