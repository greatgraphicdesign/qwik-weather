import{c as d,B as m,q as n,o as C,n as I,a as A,C as D,D as p,_,d as c,i,l as R,R as j,f as x}from"./q-CBAji49d.js";import{_ as s}from"./q-uemlvruI.js";import{b as N}from"./q-TJBU60mj.js";import{WeatherContext as q}from"./q-BIO_BSuC.js";import{W as H}from"./q-UgKcPGJe.js";const $=({track:e})=>{const[t]=d();if(e(()=>t.weatherToday),t.weatherToday){const o=t.weatherToday,r=new Date().toLocaleTimeString("en",{timeStyle:"short",hour12:!1,timeZone:o.timezone}).split(":"),l=document.querySelector(`#i${r[0]}`);if(l){l.classList.add("current");const u=l.nextElementSibling;u instanceof HTMLSpanElement&&u.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"})}}},k=m(n(()=>s(()=>import("./q-MCvHYk_K.js"),[]),"s_oQnubcoI5HI")),J=m(n(()=>s(()=>import("./q-Djp9k2la.js"),[]),"s_SdTHsMBGSa0")),V=m(n(()=>s(()=>import("./q-X3J0hX5P.js"),[]),"s_0ADYAZ4tl5U")),W=()=>{const e=C({displayLocation:"",error:"",forecast:null,query:"",weatherToday:null});I(q,e);const t=A(N),o=n(()=>s(()=>Promise.resolve().then(()=>h),void 0),"s_0CAUp0JTeY8",[t]),a=D(n(()=>s(()=>Promise.resolve().then(()=>h),void 0),"s_ZrRVap1iTHs",[e]));return p(n(()=>s(()=>Promise.resolve().then(()=>h),void 0),"s_zqpXT8B27s0",[e])),p(n(()=>s(()=>Promise.resolve().then(()=>h),void 0),"s_vg3z8wZWCPA",[e])),p(n(()=>s(()=>Promise.resolve().then(()=>h),void 0),"s_9Dk7fUYNCDI",[e])),_("div",null,{class:"weather-app"},[_("button",null,{class:"about-btn",onClick$:o},"⚙",3,null),_("div",null,{class:"inner"},_("h1",null,null,"Check the Weather",3,null),3,null),_("form",null,{class:"inner","preventdefault:submit":!0},[c(J,null,3,"H1_1"),c(j,{onPending:()=>c(V,null,3,"H1_2"),onRejected:r=>c(k,{get message(){return r.message},[i]:{message:R(r,"message")}},3,"H1_3"),onResolved:r=>(e.displayLocation=r.displayLocation,e.forecast=r.forecast,e.weatherToday=r.weatherToday,c(H,null,3,"H1_4")),value:a,[i]:{onPending:i,onRejected:i,onResolved:i,value:i}},3,"H1_5")],1,null)],1,"H1_6")};async function z(e,t){function o(b){const L=b.toUpperCase().split("").map(O=>127397+O.charCodeAt(0));return String.fromCodePoint(...L)}const a={displayLocation:"",forecast:{},weatherToday:{}};if(/,\s/.test(e)||e.length<4)throw new Error("Please enter the city name (only) or a zip code.");const r=await fetch(`https://geocoding-api.open-meteo.com/v1/search?name=${e}&count=10&language=en&format=json`,{signal:t.signal});if(!r.ok)throw new Error("Something went wrong when fetching the geo location.");const l=await r.json();if(!l.results)throw new Error(`“${e}” not found.`);const{latitude:u,longitude:g,timezone:w,name:T,admin1:f,country_code:S}=l.results[0];a.displayLocation=`${T}${f?`, ${f}`:""} ${o(S)}`;const y=await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${u}&longitude=${g}&timezone=${w}&temperature_unit=fahrenheit&forecast_days=8&daily=weathercode,temperature_2m_max,temperature_2m_min`,{signal:t.signal});if(!y.ok)throw new Error("Something went wrong when fetching the forecast.");const E=await y.json();a.forecast=E.daily;const v=await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${u}&longitude=${g}&timezone=${w}&temperature_unit=fahrenheit&forecast_days=2&hourly=weathercode,temperature_2m,temperature_2m&daily=temperature_2m_max,temperature_2m_min`,{signal:t.signal});if(!v.ok)throw new Error("Something went wrong when fetching the forecast.");const P=await v.json();return a.weatherToday=P,a}const M=({track:e,cleanup:t})=>{const[o]=d();e(()=>o.query);const a=new AbortController;return t(()=>a.abort("cleanup")),z(o.query,a)},Q=m(n(()=>s(()=>import("./q-Dm7biMwy.js"),[]),"s_5Wn3iQBlyEQ")),U=()=>{const[e]=d();document.body.classList.add("lock"),e("modal",c(Q,{content:`
          <p>This is an enhanced version of the Classy Weather project in Jonas Schmedtmann’s Ultimate React Course, converted to the Qwik framework. It is offered without warrants or represents.</p>
          <p>The data you enter is stored on this device using your browser’s built-in storage. This can be emptied by clearing your browser data. The app tracks nothing.</p>
          <p>Weather data courtesy of open-meteo.com. Enjoy!</p>
          <p><a href="/apps">More apps</a></p>
        `,[i]:{content:i}},3,"H1_0"))},B=()=>{const[e]=d(),t=localStorage.getItem("weatherLocation");t&&JSON.parse(t).length&&JSON.parse(t)!==e.query?e.query=JSON.parse(t):e.query="Bellingham"},Y=({track:e})=>{const[t]=d();e(()=>t.query);const o=localStorage.getItem("weatherLocation");o&&JSON.parse(o).length&&JSON.parse(o)!==t.query&&t.query.length||!(o&&JSON.parse(o).length)?localStorage.setItem("weatherLocation",JSON.stringify(t.query)):o&&JSON.parse(o).length&&JSON.parse(o)!==t.query&&!t.query.length&&localStorage.removeItem("weatherLocation")},h=Object.freeze(Object.defineProperty({__proto__:null,_hW:x,s_0CAUp0JTeY8:U,s_9Dk7fUYNCDI:$,s_ZrRVap1iTHs:M,s_vg3z8wZWCPA:Y,s_xYL1qOwPyDI:W,s_zqpXT8B27s0:B},Symbol.toStringTag,{value:"Module"}));export{x as _hW,U as s_0CAUp0JTeY8,$ as s_9Dk7fUYNCDI,M as s_ZrRVap1iTHs,Y as s_vg3z8wZWCPA,W as s_xYL1qOwPyDI,B as s_zqpXT8B27s0};
